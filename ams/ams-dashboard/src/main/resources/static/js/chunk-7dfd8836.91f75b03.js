(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dfd8836"],{"1cb0":function(e,t,r){},2460:function(e,t,r){"use strict";r("ce99")},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var n=r("e330"),a=r("1d80"),o=r("577e"),c=r("5899"),i=n("".replace),u="["+c+"]",l=RegExp("^"+u+u+"*"),p=RegExp(u+u+"*$"),s=function(e){return function(t){var r=o(a(t));return 1&e&&(r=i(r,l,"")),2&e&&(r=i(r,p,"")),r}};e.exports={start:s(1),end:s(2),trim:s(3)}},8552:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("7a23"),a=r("47e2");function o(){var e=Object(a["b"])(),t=e.t,r=Object(n["computed"])((function(){return t("catalog")})).value,o=Object(n["computed"])((function(){return t("databaseName")})).value,c=Object(n["computed"])((function(){return t("tableName")})).value,i=Object(n["computed"])((function(){return t("optimzerGroup")})).value,u=Object(n["computed"])((function(){return t("resourceGroup")})).value,l=Object(n["computed"])((function(){return t("parallelism")})).value,p=Object(n["computed"])((function(){return t("username")})).value,s=Object(n["computed"])((function(){return t("password")})).value,b=Object(n["computed"])((function(){return t("database",2)})).value,d=Object(n["computed"])((function(){return t("table",2)})).value;return{selectPh:t("selectPlaceholder"),inputPh:t("inputPlaceholder"),selectClPh:t("selectPlaceholder",{selectPh:r}),selectDBPh:t("selectPlaceholder",{selectPh:o}),inputDBPh:t("inputPlaceholder",{inputPh:o}),inputClPh:t("inputPlaceholder",{inputPh:r}),inputTNPh:t("inputPlaceholder",{inputPh:c}),selectOptGroupPh:t("inputPlaceholder",{inputPh:i}),resourceGroupPh:t("inputPlaceholder",{inputPh:u}),parallelismPh:t("inputPlaceholder",{inputPh:l}),usernamePh:t("inputPlaceholder",{inputPh:p}),passwordPh:t("inputPlaceholder",{inputPh:s}),filterDBPh:t("filterPlaceholder",{inputPh:b}),filterTablePh:t("filterPlaceholder",{inputPh:d})}}},"889c":function(e,t,r){"use strict";r("1cb0")},a9e3:function(e,t,r){"use strict";var n=r("83ab"),a=r("da84"),o=r("e330"),c=r("94ca"),i=r("6eeb"),u=r("1a2d"),l=r("7156"),p=r("3a9b"),s=r("d9b5"),b=r("c04e"),d=r("d039"),m=r("241c").f,f=r("06cf").f,O=r("9bf2").f,j=r("408a"),h=r("58a8").trim,v="Number",g=a[v],N=g.prototype,w=a.TypeError,z=o("".slice),y=o("".charCodeAt),C=function(e){var t=b(e,"number");return"bigint"==typeof t?t:x(t)},x=function(e){var t,r,n,a,o,c,i,u,l=b(e,"number");if(s(l))throw w("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=h(l),t=y(l,0),43===t||45===t){if(r=y(l,2),88===r||120===r)return NaN}else if(48===t){switch(y(l,1)){case 66:case 98:n=2,a=49;break;case 79:case 111:n=8,a=55;break;default:return+l}for(o=z(l,2),c=o.length,i=0;i<c;i++)if(u=y(o,i),u<48||u>a)return NaN;return parseInt(o,n)}return+l};if(c(v,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var k,G=function(e){var t=arguments.length<1?0:g(C(e)),r=this;return p(N,r)&&d((function(){j(r)}))?l(Object(t),r,G):t},S=n?m(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),I=0;S.length>I;I++)u(g,k=S[I])&&!u(G,k)&&O(G,k,f(g,k));G.prototype=N,N.constructor=G,i(a,v,G)}},b356:function(e,t,r){"use strict";function n(){var e=0,t=1,r=["25","50","100"],n=25;return{total:e,current:t,pageSize:n,pageSizeOptions:r,showQuickJumper:!0,showSizeChanger:!0,hideOnSinglePage:!1}}r.d(t,"a",(function(){return n}))},cac2:function(e,t,r){"use strict";r.r(t);var n=r("7a23"),a={class:"border-wrap"},o={class:"optimize-wrap"},c={class:"optimize-group g-flex-ac"},i={class:"left-group"},u={class:"g-mr-16"},l={class:"btn-wrap"},p={class:"g-ml-16 f-shink-0"},s={class:"text-color"},b={class:"text-color"},d={class:"content"};function m(e,t,r,m,f,O){var j=Object(n["resolveComponent"])("a-select"),h=Object(n["resolveComponent"])("a-button"),v=Object(n["resolveComponent"])("List"),g=Object(n["resolveComponent"])("a-tab-pane"),N=Object(n["resolveComponent"])("a-tabs"),w=Object(n["resolveComponent"])("scale-out-modal");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",a,[Object(n["createElementVNode"])("div",o,[Object(n["createElementVNode"])("div",c,[Object(n["createElementVNode"])("div",i,[Object(n["createElementVNode"])("span",u,Object(n["toDisplayString"])(e.$t("optimzerGroup")),1),Object(n["createVNode"])(j,{value:e.curGroupName,"onUpdate:value":t[0]||(t[0]=function(t){return e.curGroupName=t}),showSearch:!0,options:e.groupList,placeholder:e.placeholder.selectOptGroupPh,onChange:e.onChangeGroup,style:{width:"240px"}},null,8,["value","options","placeholder","onChange"])]),Object(n["createElementVNode"])("div",l,[Object(n["createElementVNode"])("span",p,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.$t("resourceOccupation"))+" ",1),Object(n["createElementVNode"])("span",s,Object(n["toDisplayString"])(e.groupInfo.occupationCore),1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.$t("core"))+" ",1),Object(n["createElementVNode"])("span",b,Object(n["toDisplayString"])(e.groupInfo.occupationMemory),1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.groupInfo.unit),1)]),Object(n["createVNode"])(h,{type:"primary",onClick:e.expansionJob,class:"g-ml-8"},{default:Object(n["withCtx"])((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.$t("scaleOut")),1)]})),_:1},8,["onClick"])])]),Object(n["createElementVNode"])("div",d,[e.showTab?(Object(n["openBlock"])(),Object(n["createBlock"])(N,{key:0,activeKey:e.activeTab,"onUpdate:activeKey":t[1]||(t[1]=function(t){return e.activeTab=t}),destroyInactiveTabPane:"",onChange:e.onChangeTab},{default:Object(n["withCtx"])((function(){return[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.tabConfig,(function(t){return Object(n["openBlock"])(),Object(n["createBlock"])(g,{key:t.value,tab:t.label,class:Object(n["normalizeClass"])([e.activeTab===t.value?"active":""])},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(v,{curGroupName:e.curGroupName,type:t.value,onRefreshCurGroupInfo:e.refreshCurGroupInfo},null,8,["curGroupName","type","onRefreshCurGroupInfo"])]})),_:2},1032,["tab","class"])})),128))]})),_:1},8,["activeKey","onChange"])):Object(n["createCommentVNode"])("",!0)])]),e.showScaleOutModal?(Object(n["openBlock"])(),Object(n["createBlock"])(w,{key:0,visible:e.showScaleOutModal,resourceGroup:"all"===e.curGroupName?"":e.curGroupName,onCancel:t[2]||(t[2]=function(t){return e.showScaleOutModal=!1}),onRefreshOptimizersTab:e.refreshOptimizersTab},null,8,["visible","resourceGroup","onRefreshOptimizersTab"])):Object(n["createCommentVNode"])("",!0)])}var f=r("5530"),O=r("1da1"),j=(r("96cf"),r("d3b7"),r("159b"),r("ac1f"),r("1276"),r("5319"),r("47e2")),h=r("6c02"),v=r("8552"),g=r("b356"),N=(r("99af"),r("b32d"));function w(){return N["a"].get("ams/v1/optimize/optimizerGroups")}function z(e){var t=e.optimizerGroup,r=e.page,n=e.pageSize;return N["a"].get("ams/v1/optimize/optimizerGroups/".concat(t,"/tables"),{params:{page:r,pageSize:n}})}function y(e){var t=e.optimizerGroup,r=e.page,n=e.pageSize;return N["a"].get("ams/v1/optimize/optimizerGroups/".concat(t,"/optimizers"),{params:{page:r,pageSize:n}})}function C(e){return N["a"].get("ams/v1/optimize/optimizerGroups/".concat(e,"/info"))}function x(e){var t=e.optimizerGroup,r=e.parallelism;return N["a"].post("ams/v1/optimize/optimizerGroups/".concat(t,"/optimizers"),{parallelism:r})}function k(e){var t=e.optimizerGroup,r=e.jobId;return N["a"].delete("ams/v1/optimize/optimizerGroups/".concat(t,"/optimizers/").concat(r))}r("a9e3");var G=Object(n["defineComponent"])({props:{visible:{type:Boolean},resourceGroup:null},emits:["cancel","refreshOptimizersTab"],setup:function(e,t){var r=t.emit,a=e,o=Object(n["ref"])(!1),c=Object(n["reactive"])(Object(v["a"])()),i=Object(n["ref"])(),u=Object(n["reactive"])({resourceGroup:a.resourceGroup||void 0,parallelism:1}),l=Object(n["reactive"])([]);function p(){return s.apply(this,arguments)}function s(){return s=Object(O["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:t=e.sent,l.length=0,(t||[]).forEach((function(e){l.push(Object(f["a"])(Object(f["a"])({},e),{},{label:e.optimizerGroupName,value:e.optimizerGroupName}))}));case 5:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function b(){i.value.validateFields().then(Object(O["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o.value=!0,e.next=3,x({optimizerGroup:u.resourceGroup||"",parallelism:Number(u.parallelism)});case 3:i.value.resetFields(),r("cancel"),r("refreshOptimizersTab"),o.value=!1;case 7:case"end":return e.stop()}}),e)})))).catch((function(){o.value=!1}))}function d(){i.value.resetFields(),r("cancel")}return Object(n["onMounted"])((function(){p()})),function(e,t){var r=Object(n["resolveComponent"])("a-select"),p=Object(n["resolveComponent"])("a-form-item"),s=Object(n["resolveComponent"])("a-input"),m=Object(n["resolveComponent"])("a-form"),f=Object(n["resolveComponent"])("a-modal");return Object(n["openBlock"])(),Object(n["createBlock"])(f,{visible:a.visible,title:e.$t("scaleOut"),confirmLoading:o.value,closable:!1,onOk:b,onCancel:d},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(m,{ref_key:"formRef",ref:i,model:Object(n["unref"])(u),class:"label-120"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(p,{name:"resourceGroup",label:e.$t("resourceGroup"),rules:[{required:!0,message:"".concat(Object(n["unref"])(c).resourceGroupPh)}]},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(r,{value:Object(n["unref"])(u).resourceGroup,"onUpdate:value":t[0]||(t[0]=function(e){return Object(n["unref"])(u).resourceGroup=e}),showSearch:!0,options:Object(n["unref"])(l),placeholder:Object(n["unref"])(c).resourceGroupPh},null,8,["value","options","placeholder"])]})),_:1},8,["label","rules"]),Object(n["createVNode"])(p,{name:"parallelism",label:e.$t("parallelism"),rules:[{required:!0,message:"".concat(Object(n["unref"])(c).parallelismPh)}]},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(s,{value:Object(n["unref"])(u).parallelism,"onUpdate:value":t[1]||(t[1]=function(e){return Object(n["unref"])(u).parallelism=e}),type:"number",placeholder:Object(n["unref"])(c).parallelismPh},null,8,["value","placeholder"])]})),_:1},8,["label","rules"])]})),_:1},8,["model"])]})),_:1},8,["visible","title","confirmLoading"])}}});const S=G;var I=S,P=(r("cd17"),r("ed3b")),T=(r("b680"),r("d257")),E={class:"list-wrap"},V=["title","onClick"],R=["title"],B=["onClick"],D=Object(n["defineComponent"])({props:{curGroupName:null,type:null},emits:["refreshCurGroupInfo"],setup:function(e,t){var r=t.emit,a=e,o=Object(j["b"])(),c=o.t,i=Object(h["e"])(),u=Object(n["shallowReactive"])({pending:{title:"pending",color:"#ffcc00"},idle:{title:"idle",color:"#c9cdd4"},minor:{title:"minor",color:"#0ad787"},major:{title:"major",color:"#0ad787"},full:{title:"full",color:"#0ad787"}}),l=Object(n["ref"])(!1),p=Object(n["ref"])(!1),s=Object(n["shallowReactive"])([{dataIndex:"tableName",title:c("table"),ellipsis:!0,scopedSlots:{customRender:"tableName"}},{dataIndex:"groupName",title:c("optimizerGroup"),width:"16%",ellipsis:!0},{dataIndex:"optimizeStatus",title:c("optimizingStatus"),width:"16%",ellipsis:!0},{dataIndex:"durationDisplay",title:c("duration"),width:"10%",ellipsis:!0},{dataIndex:"fileCount",title:c("fileCount"),width:"10%",ellipsis:!0},{dataIndex:"fileSizeDesc",title:c("fileSize"),width:"10%",ellipsis:!0},{dataIndex:"quota",title:c("quota"),width:"10%",ellipsis:!0},{dataIndex:"quotaOccupationDesc",title:c("occupation"),width:120,ellipsis:!0}]),b=Object(n["shallowReactive"])([{dataIndex:"index",title:c("order"),width:80,ellipsis:!0},{dataIndex:"groupName",title:c("optimizerGroup"),ellipsis:!0},{dataIndex:"container",title:c("container"),ellipsis:!0},{dataIndex:"jobStatus",title:c("status"),ellipsis:!0},{dataIndex:"resourceAllocation",title:c("resourceAllocation"),width:"20%",ellipsis:!0},{dataIndex:"operation",title:c("operation"),key:"operation",ellipsis:!0,width:160,scopedSlots:{customRender:"operation"}}]),d=Object(n["reactive"])(Object(g["a"])()),m=Object(n["reactive"])([]),f=Object(n["reactive"])([]),v=Object(n["computed"])((function(){return"optimizers"===a.type?b:s})),N=Object(n["computed"])((function(){return"optimizers"===a.type?m:f}));function w(e){e&&(d.current=1),"optimizers"===a.type?C():G()}function C(){return x.apply(this,arguments)}function x(){return x=Object(O["a"])(regeneratorRuntime.mark((function e(){var t,r,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,m.length=0,l.value=!0,t={optimizerGroup:a.curGroupName,page:d.current,pageSize:d.pageSize},e.next=6,y(t);case 6:r=e.sent,n=r.list,o=r.total,d.total=o,(n||[]).forEach((function(e,t){e.resourceAllocation="".concat(e.coreNumber," ").concat(c("core")," ").concat(Object(T["h"])(e.memory)),e.index=(d.current-1)*d.pageSize+t+1,m.push(e)})),e.next=14;break;case 12:e.prev=12,e.t0=e["catch"](0);case 14:return e.prev=14,l.value=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,12,14,17]])}))),x.apply(this,arguments)}function G(){return S.apply(this,arguments)}function S(){return S=Object(O["a"])(regeneratorRuntime.mark((function e(){var t,r,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,f.length=0,l.value=!0,t={optimizerGroup:a.curGroupName||"",page:d.current,pageSize:d.pageSize},e.next=6,z(t);case 6:r=e.sent,n=r.list,o=r.total,d.total=o,(n||[]).forEach((function(e){e.quotaOccupationDesc=e.quotaOccupation-5e-4>0?"".concat((100*e.quotaOccupation).toFixed(1),"%"):"0",e.durationDesc=Object(T["e"])(e.duration||0),e.durationDisplay=Object(T["d"])(e.duration||0),e.fileSizeDesc=Object(T["a"])(e.fileSize),f.push(e)})),e.next=14;break;case 12:e.prev=12,e.t0=e["catch"](0);case 14:return e.prev=14,l.value=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,12,14,17]])}))),S.apply(this,arguments)}function I(e){"external"!==e.containerType&&P["a"].confirm({title:c("releaseOptModalTitle"),content:"",okText:"",cancelText:"",onOk:function(){D(e)}})}function D(e){return _.apply(this,arguments)}function _(){return _=Object(O["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,p.value=!0,e.next=4,k({optimizerGroup:t.groupName,jobId:t.jobId});case 4:w(!0),r("refreshCurGroupInfo");case 6:return e.prev=6,p.value=!1,e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[0,,6,9]])}))),_.apply(this,arguments)}function M(e){var t=e.current,r=void 0===t?d.current:t,n=e.pageSize,a=void 0===n?d.pageSize:n;d.current=r;var o=a!==d.pageSize;d.pageSize=a,w(o)}function F(e){var t=e.tableIdentifier,r=t.catalog,n=t.database,a=t.tableName;i.push({path:"/tables",query:{catalog:r,db:n,table:a}})}return Object(n["watch"])((function(){return a.curGroupName}),(function(e){e&&w()})),Object(n["onMounted"])((function(){w()})),function(e,t){var r=Object(n["resolveComponent"])("a-table"),a=Object(n["resolveComponent"])("u-loading");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createElementVNode"])("div",E,[Object(n["createVNode"])(r,{class:"ant-table-common",columns:Object(n["unref"])(v),"data-source":Object(n["unref"])(N),pagination:Object(n["unref"])(d),loading:l.value,onChange:M},{bodyCell:Object(n["withCtx"])((function(e){var t=e.column,r=e.record;return["tableName"===t.dataIndex?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,title:r.tableName,class:"primary-link",onClick:function(e){return F(r)}},Object(n["toDisplayString"])(r.tableName),9,V)):Object(n["createCommentVNode"])("",!0),"durationDisplay"===t.dataIndex?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:1,title:r.durationDesc},Object(n["toDisplayString"])(r.durationDisplay),9,R)):Object(n["createCommentVNode"])("",!0),"optimizeStatus"===t.dataIndex?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:2},[Object(n["createElementVNode"])("span",{style:Object(n["normalizeStyle"])({"background-color":(Object(n["unref"])(u)[r.optimizeStatus]||{}).color}),class:"status-icon"},null,4),Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(r.optimizeStatus),1)],64)):Object(n["createCommentVNode"])("",!0),"operation"===t.dataIndex?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:3,class:Object(n["normalizeClass"])(["primary-link",{disabled:"external"===r.containerType}]),onClick:function(e){return I(r)}},Object(n["toDisplayString"])(Object(n["unref"])(c)("release")),11,B)):Object(n["createCommentVNode"])("",!0)]})),_:1},8,["columns","data-source","pagination","loading"])]),p.value?(Object(n["openBlock"])(),Object(n["createBlock"])(a,{key:0})):Object(n["createCommentVNode"])("",!0)],64)}}}),_=(r("889c"),r("6b0d")),M=r.n(_);const F=M()(D,[["__scopeId","data-v-df28c88e"]]);var q=F,A=Object(n["defineComponent"])({name:"Optimize",components:{List:q,ScaleOutModal:I},setup:function(){var e=Object(j["b"])(),t=e.t,r=Object(h["e"])(),a=Object(h["d"])(),o=Object(n["shallowReactive"])([{label:t("optimizers"),value:"optimizers"},{label:t("tables"),value:"tables"}]),c=Object(n["reactive"])(Object(v["a"])()),i=Object(n["reactive"])(Object(g["a"])()),u=Object(n["reactive"])({curGroupName:"all",groupList:[{label:t("allGroups"),value:"all"}],groupInfo:{occupationCore:0,occupationMemory:0,unit:""},activeTab:"tables",showScaleOutModal:!1,showTab:!1}),l=Object(n["computed"])((function(){return"tables"===u.activeTab}));Object(n["watch"])((function(){return a.query}),(function(e){u.activeTab=e.tab||"tables"}),{immediate:!0});var p=function(){d()},s=function(){d()},b=function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:t=e.sent,(t||[]).forEach((function(e){u.groupList.push({label:e.optimizerGroupName,value:e.optimizerGroupName})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,C(u.curGroupName||"");case 2:t=e.sent,r=Object(T["h"])(t.occupationMemory||0),n=r.split(" "),u.groupInfo={occupationCore:t.occupationCore,occupationMemory:n[0],unit:n[1]||""};case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){u.showScaleOutModal=!0},N=function(){z("optimizers"),u.showTab=!1,Object(n["nextTick"])((function(){u.showTab=!0})),d()},z=function(e){var t=Object(f["a"])({},a.query);t.tab=e,r.replace({query:Object(f["a"])({},t)})};return Object(n["onMounted"])((function(){u.showTab=!0,b(),d()})),Object(f["a"])(Object(f["a"])({isTableTab:l,placeholder:c,pagination:i},Object(n["toRefs"])(u)),{},{tabConfig:o,onChangeGroup:p,refreshCurGroupInfo:s,expansionJob:m,refreshOptimizersTab:N,onChangeTab:z})}});r("2460");const L=M()(A,[["render",m],["__scopeId","data-v-f9a0bade"]]);t["default"]=L},ce99:function(e,t,r){}}]);